import pyautogui
import platform
import os
import subprocess
from scaledefine import get_scale_factor
import time
import cv2
import numpy as np

def resize_image(image, scale_factor):
    # Ändra bildens storlek med angiven skalfaktor
    resized_image = cv2.resize(image, (0, 0), fx=1/scale_factor, fy=1/scale_factor, interpolation=cv2.INTER_LINEAR)
    return resized_image

def image_click():
    try:
        image_path = 'img/08_image.JPG'
        scale_factor = get_scale_factor()

        # Läs in sökbilden
        search_image = cv2.imread(image_path)

        if scale_factor is not None:
            # Skala om den sökta bilden med hjälp av den fastställda skalfaktorn
            resized_image = resize_image(search_image, scale_factor)

        found_image = pyautogui.locateOnScreen(resized_image, confidence=0.8)

        if found_image is not None:
            center_x, center_y = pyautogui.center(found_image)

            print(f"Bilden hittades!")
            pyautogui.moveTo(found_image) #center_x, center_y)
        else:
            print(f"Bilden hittades inte.")
    except Exception as e:
        print(f"Fel vid bildsökning: {str(e)}")

# Anropa image_click-funktionen
image_click()
